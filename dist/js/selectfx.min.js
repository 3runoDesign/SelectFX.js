/*selectfx.js v1.0.0 - Improve the style of your selection. Based on from SelectInspiration - https://github.com/codrops/SelectInspiration
    Copyright (c) 2014 Mibuz Team <contato@mibuz.com.br> - http://mibuz.com.br
    License: MIT*/

var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};!function(window,document){"use strict";var BaseModules,SelectFx;return BaseModules=function(){function BaseModules(){}var addClass,capitaliseString,classReg,extendObjs,fireEvent,hasClass,hasParent,isMobile,removeClass,toggleClass;return fireEvent=function(obj,evt){var evObj,fireOnThis;return fireOnThis=obj,document.createEvent?(evObj=document.createEvent("MouseEvents"),evObj.initEvent(evt,!0,!1),fireOnThis.dispatchEvent(evObj)):document.createEventObject?(evObj=document.createEventObject(),fireOnThis.fireEvent("on"+evt,evObj)):void 0},capitaliseString=function(string){return string.charAt(0).toUpperCase()+string.slice(1).toLowerCase()},classReg=function(className){return new RegExp("(^|\\s+)"+className+"(\\s+|$)")},hasClass=function(elem,c){return-1!==elem.className.indexOf(c)},addClass=function(elem,c){return elem.className=""+elem.className+" "+c},removeClass=function(elem,c){return elem.className=elem.className.replace(classReg(c),"")},toggleClass=function(elem,c){var fn;return(fn=hasClass(elem,c)?removeClass:addClass)(elem,c)},extendObjs=function(obj1,obj2){var e,p;for(p in obj2)try{obj1[p]=obj2[p].constructor===Object?extendObjs(obj1[p],obj2[p]):obj2[p]}catch(_error){e=_error,obj1[p]=obj2[p]}return obj1},hasParent=function(e,p){var el;if(!e)return!1;for(el=e.target||e.srcElement||e||!1;el&&el!==p;)el=el.parentNode||!1;return el!==!1},isMobile=function(){return navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i)},BaseModules.prototype.has=hasClass,BaseModules.prototype.add=addClass,BaseModules.prototype.remove=removeClass,BaseModules.prototype.toggle=toggleClass,BaseModules.prototype.extend=extendObjs,BaseModules.prototype.hasParent=hasParent,BaseModules.prototype.isMobile=isMobile,BaseModules.prototype.fireEvent=fireEvent,BaseModules.prototype.capitalise=capitaliseString,BaseModules}(),SelectFx=function(_super){function SelectFx(el,options){options=this.extend(this.constructor.options,options),this.el=el,this.options=options,this._init()}return __extends(SelectFx,_super),SelectFx.options={onMobile:!0,classes:{baseClass:"sfx-select",styleClass:"sfx-default",selectedClass:"sfx-selected",placeholderClass:"sfx-placeholder",optgroupClass:"sfx-optgroup",optionsClass:"sfx-options",focusClass:"sfx-focus",activeClass:"sfx-active",mobileClass:"sfx-mobile"},onChange:function(){return!1}},SelectFx.newTab=!0,SelectFx.stickyPlaceholder=!0,SelectFx.prototype._init=function(){var selectedOpt;return selectedOpt=this.el.querySelector("option[selected]"),this.hasDefaultPlaceholder=selectedOpt&&selectedOpt.disabled,this.selectedOpt=selectedOpt||this.el.querySelector("option"),this._createSelectEl(),this.selOpts=[].slice.call(this.selEl.querySelectorAll("li[data-option]")),this.selOptsCount=this.selOpts.length,this.current=this.selOpts.indexOf(this.selEl.querySelector("."+this.options.classes.selectedClass))||-1,this.selPlaceholder=this.selEl.querySelector("."+this.options.classes.placeholderClass),this._initEvents()},SelectFx.prototype._createSelectEl=function(){var classMobile,createOptionHTML,options,opts_el,self;return self=this,options="",createOptionHTML=function(el){var classes,link,optclass;return optclass="",classes="",link="",self.selectedOpt.value!==el.value||self.foundSelected||self.hasDefaultPlaceholder||(classes+=""+self.options.classes.selectedClass+" ",self.foundSelected=!0),el.getAttribute("data-class")&&(classes+=el.getAttribute("data-class")),el.getAttribute("data-link")&&(link="data-link="+el.getAttribute("data-link")),""!==classes&&(optclass='class="'+classes+'" '),""!==el.value&&""===el.text?"<li "+optclass+link+' data-option data-value="'+el.value+'"><span>'+el.value+"</span></li>":"<li "+optclass+link+' data-option data-value="'+el.value+'"><span>'+el.textContent+"</span></li>"},[].slice.call(this.el.children).forEach(function(el){var tag;if(!el.disabled)return tag=el.tagName.toLowerCase(),"option"===tag&&""!==el.value?options+=createOptionHTML(el):"optgroup"===tag?(options+='<li data-optgroup class="'+self.options.classes.optgroupClass+'"><span class="'+self.options.classes.optgroupClass+'-title">'+el.label+"</span><ul>",[].slice.call(el.children).forEach(function(opt){return""!==opt.value?options+=createOptionHTML(opt):void 0}),options+="</ul></li>"):void 0}),classMobile=this.isMobile()&&this.options.onMobile?this.options.mobileClass:"",opts_el='<div class="'+this.options.classes.optionsClass+'"><ul>'+options+"</ul></div>",this.selEl=document.createElement("div"),this.selEl.className=""+this.options.classes.baseClass+" "+this.options.classes.styleClass,this.selEl.tabIndex=this.el.tabIndex,this.selEl.id="select"+this.capitalise(this.el.getAttribute("id")),this.selEl.innerHTML='<span class="'+this.options.classes.placeholderClass+'"> <dl><dt>'+this.selectedOpt.textContent+"</dl></dt></span>"+opts_el,this.el.parentNode.appendChild(this.selEl),this.selEl.appendChild(this.el)},SelectFx.prototype._initEvents=function(){var self;return self=this,this.el.labels[0]&&this.el.labels[0].addEventListener("click",function(){return self.fireEvent(self.selPlaceholder,"click"),event.stopPropagation()}),this.selPlaceholder.addEventListener("click",function(){return self._toggleSelect()}),this.selOpts.forEach(function(opt,idx){return opt.addEventListener("click",function(){return self.current=idx,self._changeOption(),self._toggleSelect()})}),document.addEventListener("click",function(ev){var target;return target=ev.target,self._isOpen()&&target!==self.selEl&&!self.hasParent(target,self.selEl)?self._toggleSelect():void 0}),this.selEl.addEventListener("keydown",function(ev){var keyCode;switch(keyCode=ev.keyCode||ev.which){case 38:return ev.preventDefault(),self._navigateOpts("prev");case 40:return ev.preventDefault(),self._navigateOpts("next");case 32:return ev.preventDefault(),self._isOpen()&&"undefined"!=typeof self.preSelCurrent&&-1!==self.preSelCurrent&&self._changeOption(),self._toggleSelect();case 13:if(ev.preventDefault(),self._isOpen()&&"undefined"!=typeof self.preSelCurrent&&-1!==self.preSelCurrent)return self._changeOption(),self._toggleSelect();break;case 27:if(ev.preventDefault(),self._isOpen())return self._toggleSelect()}})},SelectFx.prototype._navigateOpts=function(dir){var tmpcurrent;return this._isOpen()||this._toggleSelect(),tmpcurrent="undefined"!=typeof this.preSelCurrent&&-1!==this.preSelCurrent?this.preSelCurrent:this.current,"prev"===dir&&tmpcurrent>0||"next"===dir&&tmpcurrent<this.selOptsCount-1?(this.preSelCurrent="next"===dir?tmpcurrent+1:tmpcurrent-1,this._removeFocus(),this.add(this.selOpts[this.preSelCurrent],""+this.options.classes.focusClass)):void 0},SelectFx.prototype._toggleSelect=function(){return this._removeFocus(),this._isOpen()?(-1!==this.current&&(this.selPlaceholder.querySelector("dl dt").textContent=this.selOpts[this.current].textContent),this.remove(this.selEl,""+this.options.classes.activeClass)):this._isOpen()?void 0:(this.hasDefaultPlaceholder&&this.constructor.stickyPlaceholder&&(this.selPlaceholder.querySelector("dl dt").textContent=this.selectedOpt.textContent),this.add(this.selEl,""+this.options.classes.activeClass))},SelectFx.prototype._changeOption=function(){var oldOpt,opt;return"undefined"!=typeof this.preSelCurrent&&-1!==this.preSelCurrent&&(this.current=this.preSelCurrent,this.preSelCurrent=-1),opt=this.selOpts[this.current],this.selPlaceholder.querySelector("dl dt").textContent=opt.textContent,this.el.value=opt.getAttribute("data-value"),oldOpt=this.selEl.querySelector("."+this.options.classes.selectedClass),oldOpt&&this.remove(oldOpt,""+this.options.classes.selectedClass),this.add(opt,""+this.options.classes.selectedClass),opt.getAttribute("data-link")&&(this.constructor.newTab?window.open(opt.getAttribute("data-link"),"_blank"):window.location=opt.getAttribute("data-link")),this.options.onChange(this.el.value)},SelectFx.prototype._isOpen=function(){return this.has(this.selEl,""+this.options.classes.activeClass)},SelectFx.prototype._removeFocus=function(){var focusEl;return focusEl=this.selEl.querySelector("."+this.options.classes.focusClass),focusEl?this.remove(focusEl,""+this.options.classes.focusClass):void 0},SelectFx}(BaseModules),window.SelectFx=SelectFx}(window,document);